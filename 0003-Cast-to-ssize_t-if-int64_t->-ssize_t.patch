From 96cb19e426b2f5ac2780559905765e7f650c5032 Mon Sep 17 00:00:00 2001
From: pandaninjas <admin@malwarefight.wip.la>
Date: Tue, 16 May 2023 17:27:27 -0400
Subject: [PATCH] Cast to ssize_t if int64_t > ssize_t

---
 torch/csrc/jit/python/python_list.cpp | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/torch/csrc/jit/python/python_list.cpp b/torch/csrc/jit/python/python_list.cpp
index ee2e7a7612..2da72b2712 100644
--- a/torch/csrc/jit/python/python_list.cpp
+++ b/torch/csrc/jit/python/python_list.cpp
@@ -28,7 +28,13 @@ bool ScriptListIterator::done() const {
 
 namespace {
 py::list scriptListToPyList(const ScriptList& src) {
-  py::list out(src.len());
+  py::list out;
+  if (sizeof (int64_t) > sizeof (ssize_t)) {
+    assert(src.len() < PY_SSIZE_T_MAX);
+    out(static_cast<ssize_t>(src.len()));
+  } else {
+    out(src.len());
+  }
   auto iter = src.iter();
 
   size_t i = 0;
-- 
2.34.1

